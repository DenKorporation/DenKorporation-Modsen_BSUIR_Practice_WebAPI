# Практическое задание 2

## Интернет-магазин на основе ASP.NET Core Web API

### Описание

Данное задание рассчитано на выполнение в течение двух недель. Основной целью проекта является разработка интернет-магазина с использованием ASP.NET Core Web API. Проект включает в себя создание функционала для управления товарами, категориями, заказами и элементами заказов в базе данных. Дополнительно предусмотрен механизм аутентификации пользователей для обеспечения безопасности системы.

### Неделя 1

---

### Разработка структуры и архитектуры.

Постройте концептуальное решение для вашего проекта, опираясь на N-Layer Architecture. Разделите проект на уровни: Presentation Layer, Business Logic Layer, Data Access Layer. Начните разработку Data Access Layer, который будет обеспечивать взаимодействие с базой данных. Создайте модели, соответствующие таблицам базы данных, таким как:

- **Таблица Products**: содержит информацию о товарах.
- **Таблица Categories**: содержит информацию о категориях товаров.
- **Таблица Orders**: содержит информацию о заказах с ссылкой на таблицу Users.
- **Таблица OrderItems**: содержит информацию о товарах в каждом заказе с ссылкой на таблицу Products.
- **Таблица Users**: содержит информацию о пользователях.

### Требования к взаимодействию с базой данных

- Для работы с базой данных используйте EF Core.
- Примените подход Code First для создания схемы базы данных.
- Воспользуйтесь EF Fluent API для конфигурации моделей.
- Для управления изменениями в схеме базы данных применяйте миграции.

### Реализация репозиториев

Начните создавать необходимые репозитории для взаимодействия с базой данных. Реализуйте репозитории для товаров, категорий, заказов, товаров в заказах и пользователей. Ожидаемый функционал включает:

- Создание, чтение, обновление и удаление товаров.
- Получение списка всех товаров.
- Получение подробной информации о конкретном товаре по его Id.
- Получение товаров по определенной категории.
- Создание, чтение, обновление и удаление категорий.
- Возможность просмотра всех категорий.
- Создание новых заказов.
- Получение списка всех заказов.
- Получение всех заказов по конкретному пользователю.
- Получение информации о конкретном заказе по его Id, включая состав заказанных товаров и их количества.

Асинхронное программирование Внедрите асинхронное программирование для работы с базой данных, используя асинхронные методы в репозиториях для обеспечения эффективной и отзывчивой работы с базой данных.

Начните реализацию Business Logic Layer. Создайте классы, которые будут использоваться как входные параметры и выходные данные в сервисах. Определите интерфейсы с методами для всех сервисов на основе этих классов. Добавьте валидацию входных параметров (классов) через FluentValidation.

### Неделя 2

---

Продолжайте разрабатывать Business Logic Layer. Сделайте реализацию всех интерфейсов для сервисов и соответствующих методов. Внутри сервисов тщательно проверяйте корректность входных данных и условий выполнения операций. В случае обнаружения некорректных данных или отсутствия необходимых условий, выбрасывайте свои собственные исключения с четкими сообщениями об ошибке. Например, при попытке аутентификации пользователя, если указанный пользователь не найден, выбрасывайте исключение. Аналогично, перед удалением или обновлением модели, проверяйте ее существование, и в случае отсутствия выбрасывайте соответствующее исключение.

Добавьте функционал для регистрации новых пользователей и аутентификации пользователей через JWT. Создайте необходимые сервисы для этих операций, включая мапперы для удобного преобразования классов с похожими данными.

Затем приступите к разработке Presentation Layer.

В рамках данного проекта создайте контроллеры с минимальной логикой. Контроллеры должны вызывать соответствующие сервисы и возвращать результат клиенту. Все исключительные ситуации, включая ошибки, должны обрабатываться через глобальный обработчик исключений. Глобальный обработчик должен обеспечивать централизованное управление исключениями для всего приложения, предоставляя клиенту понятные ошибки.

Настройте созданные валидаторы через FluentValidation, чтобы они автоматически выполняли валидацию входных параметров при вызове соответствующих сервисов. Реализуйте принцип Automatic Validation, где система автоматически применяет валидацию, не требуя явного вызова из кода.

Убедитесь, что ваши валидаторы подключены к соответствующим классам входных параметров сервисов. Кроме того, ваши контроллеры в Presentation Layer должны автоматически инициировать валидацию, когда получают запросы от клиента.
